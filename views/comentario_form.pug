extends layout

block content
  .container.my-5.col-md-7 // Contenedor centrado
    
    // Título de la vista
    h1.display-5.mb-4.pb-2.border-bottom= title

    // Mensajes Flash (Errores de permisos, éxito, etc.)
    if error_msg
      .alert.alert-danger= error_msg

    // Formulario de Edición
    // 1. CORRECCIÓN: Usamos comentario._id para la URL POST
    form(method='POST', action=`/posts/${post_id}/comentarios/${comentario._id}/update`)
      
      // Manejo de Errores de Validación 
      if errors && errors.length
        .alert.alert-danger.mb-3
          p.fw-bold Se encontraron errores de validación:
          ul.mb-0
            each error in errors
              li= error.msg

      .mb-3
        label.form-label.fw-bold(for='content') Editar Contenido
        // El contenido se pasa correctamente: comentario.content
        textarea.form-control#content(
          name='content', 
          rows='5', 
          required,
          placeholder='Escribe tu comentario aquí...'
        )= comentario.content 
      
      .d-flex.gap-3.mt-4
        button.btn.btn-primary.btn-lg(type='submit') Guardar Cambios
        
        // 2. CORRECCIÓN: Usamos comentario._id para el enlace de Cancelar
        a.btn.btn-secondary.btn-lg(href=`/posts/${post_id}#comentario-${comentario._id}`) Cancelar